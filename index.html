<!DOCTYPE html>
<html>
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>Graduación 2024 - Luis Pedro Gómez de la Roca</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <!-- we import arjs version without NFT but with marker + location based support -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <body style="margin : 0px; overflow: hidden;">
        <a-scene embedded arjs>
            <a-marker type="pattern" url="markers/pattern-birrete.patt">
                <!-- This is where we'll display the current image -->
                <a-plane id="image-display" position="0 0 0.5" rotation="-90 0 0"
                material="opacity: 1; transparent: true"></a-plane>
            </a-marker>
            <a-entity camera></a-entity>
        </a-scene>

        <script>
            // Scaling factor relative to marker size
            const scalingFactor = 3;
            
            // Define the marker's reference size (e.g., 1x1 units)
            const markerReferenceSize = 1;

            // Path to the image you want to use
            const imagePath = 'img/1.JPG';

            // Function to dynamically set the plane's dimensions relative to marker size
            function setPlaneDimensions(imagePath, scalingFactor, markerSize) {
                // Create a new Image object
                const img = new Image();

                // Load the image and get its natural dimensions
                img.onload = function () {
                    const originalWidth = img.naturalWidth;
                    const originalHeight = img.naturalHeight;

                    // Calculate the image aspect ratio
                    const imageAspectRatio = originalWidth / originalHeight;

                    // Calculate the plane's width and height relative to the marker size
                    // We'll keep the marker's size as the "height" reference and scale the width accordingly
                    const newHeight = markerSize * scalingFactor;
                    const newWidth = newHeight * imageAspectRatio; // Maintaining the aspect ratio

                    // Get the a-plane element
                    const plane = document.querySelector('#image-display');

                    // Set the image as the texture source
                    plane.setAttribute('src', imagePath);

                    // Set the new dimensions
                    plane.setAttribute('width', newWidth);  // Use the calculated width
                    plane.setAttribute('height', newHeight);  // Use the calculated height
                };

                // Set the source of the image to trigger the load event
                img.src = imagePath;
            }

            // Call the function with the desired image path, scaling factor, and marker size
            setPlaneDimensions(imagePath, scalingFactor, markerReferenceSize);
        </script>
    </body>
</html>